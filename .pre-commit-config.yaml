# ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«å›£ Pre-commitè¨­å®š
# 921å€‹ã®å•é¡Œã‚’è‡ªå‹•æ¤œå‡ºãƒ»ä¿®æ­£ã—ã€ä»Šå¾Œã®å•é¡Œç™ºç”Ÿã‚’é˜²ã
# å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚»ãƒ«ãƒ•ãƒ’ãƒ¼ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ 

repos:
  # åŸºæœ¬çš„ãªPythonãƒã‚§ãƒƒã‚¯
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        name: "ğŸ§¹ ç©ºç™½é™¤å»é¨å£«"
      - id: end-of-file-fixer
        name: "ğŸ“„ ãƒ•ã‚¡ã‚¤ãƒ«çµ‚ç«¯ä¿®æ­£é¨å£«"
      - id: check-yaml
        name: "ğŸ“‹ YAMLæ¤œè¨¼é¨å£«"
      - id: check-json
        name: "ğŸ”§ JSONæ¤œè¨¼é¨å£«"
      - id: check-xml
        name: "ğŸ“ XMLæ¤œè¨¼é¨å£«"
      - id: check-toml
        name: "âš™ï¸ TOMLæ¤œè¨¼é¨å£«"
      - id: check-merge-conflict
        name: "âš”ï¸ ãƒãƒ¼ã‚¸ç«¶åˆæ¤œå‡ºé¨å£«"
      - id: check-added-large-files
        name: "ğŸ“¦ å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«æ¤œå‡ºé¨å£«"
        args: [--maxkb=5000]
      - id: check-case-conflict
        name: "ğŸ”¤ ãƒ•ã‚¡ã‚¤ãƒ«åç«¶åˆæ¤œå‡ºé¨å£«"
      - id: check-docstring-first
        name: "ğŸ“ Docstringæ¤œè¨¼é¨å£«"
      - id: check-executables-have-shebangs
        name: "ğŸš€ å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼é¨å£«"
      - id: debug-statements
        name: "ğŸ› ãƒ‡ãƒãƒƒã‚°æ–‡æ¤œå‡ºé¨å£«"
      - id: name-tests-test
        name: "ğŸ§ª ãƒ†ã‚¹ãƒˆå‘½åè¦å‰‡é¨å£«"
        args: [--pytest-test-first]
      - id: check-ast
        name: "ğŸ Pythonæ§‹æ–‡æ¤œè¨¼é¨å£«"
      - id: fix-byte-order-marker
        name: "ğŸ”¤ BOMé™¤å»é¨å£«"
      - id: mixed-line-ending
        name: "ğŸ“ æ”¹è¡Œã‚³ãƒ¼ãƒ‰çµ±ä¸€é¨å£«"
        args: ['--fix=lf']

  # Python importä¿®æ­£ï¼ˆ921å€‹ã®å•é¡Œã®ä¸»è¦åŸå› ï¼‰
  - repo: https://github.com/PyCQA/isort
    rev: 5.13.2
    hooks:
      - id: isort
        name: "ğŸ“¦ ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ•´ç†é¨å£«"
        args: [--profile=black, --line-length=120, --force-single-line, --force-alphabetical-sort-within-sections]

  # æœªä½¿ç”¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆé™¤å»ï¼ˆè‡ªå‹•ä¿®æ­£ï¼‰
  - repo: https://github.com/PyCQA/autoflake
    rev: v2.2.1
    hooks:
      - id: autoflake
        name: "ğŸ§¹ æœªä½¿ç”¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆé™¤å»é¨å£«"
        args: [
          "--in-place",
          "--remove-all-unused-imports",
          "--remove-unused-variables",
          "--remove-duplicate-keys",
          "--expand-star-imports",
          "--ignore-init-module-imports"
        ]

  # Pythonã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
  - repo: https://github.com/psf/black
    rev: 24.3.0
    hooks:
      - id: black
        name: "ğŸ¨ ã‚³ãƒ¼ãƒ‰æ•´å½¢é¨å£«"
        language_version: python3.12
        args: [--line-length=120]

  # Pythonãƒªãƒ³ã‚¿ãƒ¼ï¼ˆRuffã«ã‚ˆã‚‹é«˜é€Ÿãƒã‚§ãƒƒã‚¯ï¼‰
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.1.14
    hooks:
      - id: ruff
        name: "ğŸ” ã‚³ãƒ¼ãƒ‰å“è³ªæ¤œæŸ»é¨å£«"
        args: [--fix, --exit-non-zero-on-fix, --line-length=120]

  # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œæŸ»
  - repo: https://github.com/PyCQA/bandit
    rev: 1.7.5
    hooks:
      - id: bandit
        name: "ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œæŸ»é¨å£«"
        args: [-ll, -i, -r, ., -x, tests,venv,node_modules,dashboard_env,projects]

  # Docstringæ¤œè¨¼
  - repo: https://github.com/pycqa/pydocstyle
    rev: 6.3.0
    hooks:
      - id: pydocstyle
        name: "ğŸ“š Docstringæ¤œè¨¼é¨å£«"
        args: [--convention=google]

  # å‹ãƒã‚§ãƒƒã‚¯
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.8.0
    hooks:
      - id: mypy
        name: "ğŸ”’ å‹æ¤œè¨¼é¨å£«"
        args: [--ignore-missing-imports, --no-strict-optional]
        additional_dependencies: [types-requests, types-pyyaml]
        files: ^(libs|commands|workers)/.*\.py$

  # ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
  - repo: local
    hooks:
      # æ—¢å­˜ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«å›£ã‚¬ãƒ¼ãƒ‰
      - id: incident-knights-guard
        name: "ğŸ›¡ï¸ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«å›£ã‚¬ãƒ¼ãƒ‰"
        entry: python3 -m libs.precommit_incident_guard
        language: python
        pass_filenames: false
        always_run: true
        description: "ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰ç‹¬è‡ªã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£&ãƒªã‚¹ã‚¯æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ "

      # æ–°è¦ï¼šè‡ªå·±ä¿®å¾©ã‚·ã‚¹ãƒ†ãƒ 
      - id: knights-self-healing
        name: "âš”ï¸ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«å›£è‡ªå‹•ä¿®å¾©"
        entry: python3 scripts/knights_self_healing.py --auto-fix
        language: python
        pass_filenames: false
        always_run: true
        stages: [pre-commit]
        description: "921å€‹ã®å•é¡Œã‚’è‡ªå‹•æ¤œå‡ºãƒ»ä¿®æ­£"

      # æ–°è¦ï¼šã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼è‡ªå‹•ä¿®å¾©
      - id: import-error-auto-fix
        name: "ğŸ“¦ ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼è‡ªå‹•ä¿®å¾©é¨å£«"
        entry: python3 scripts/fix_import_errors.py
        language: python
        files: \.py$
        pass_filenames: true
        stages: [pre-commit]
        description: "ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼ã‚’è‡ªå‹•çš„ã«ä¿®æ­£"

      # æ–°è¦ï¼šã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºãƒ»ãƒãƒ¼ãƒ¢ãƒ‹ãƒ¼æ•´åˆæ€§
      - id: elder-harmony-check
        name: "ğŸ›ï¸ ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºãƒ»ãƒãƒ¼ãƒ¢ãƒ‹ãƒ¼æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯"
        entry: python3 scripts/check_elder_harmony.py
        language: python
        pass_filenames: false
        always_run: true
        stages: [pre-commit]
        description: "4è³¢è€…ã‚·ã‚¹ãƒ†ãƒ ã®æ•´åˆæ€§ã‚’ç¢ºèª"

      # æ–°è¦ï¼šç’°å¢ƒå¤‰æ•°è‡ªå‹•è£œå®Œ
      - id: env-auto-setup
        name: "ğŸ”§ ç’°å¢ƒå¤‰æ•°è‡ªå‹•è£œå®Œé¨å£«"
        entry: python3 scripts/env_auto_setup.py
        language: python
        pass_filenames: false
        always_run: true
        stages: [pre-commit]
        description: "å¿…è¦ãªç’°å¢ƒå¤‰æ•°ã‚’è‡ªå‹•è¨­å®š"

      # æ–°è¦ï¼šãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç›£è¦–
      - id: test-coverage-guard
        name: "ğŸ“Š ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç›£è¦–é¨å£«"
        entry: python3 scripts/coverage_guard.py --min-coverage=80
        language: python
        pass_filenames: false
        stages: [pre-push]
        description: "ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šã‚’ä¿è¨¼"

# Configuration
default_language_version:
  python: python3.12

fail_fast: false

# CI-specific settings
ci:
  autofix_commit_msg: |
    [pre-commit.ci] auto fixes from pre-commit hooks

    for more information, see https://pre-commit.ci
  autofix_prs: true
  autoupdate_branch: ''
  autoupdate_commit_msg: '[pre-commit.ci] pre-commit autoupdate'
  autoupdate_schedule: weekly
  skip: []
  submodules: false
