#!/bin/bash
# AI Elder - Enhanced Claude CLI with Elders Guild Knowledge
# ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰çµ±åˆClaude CLI

# ä½¿ç”¨æ–¹æ³•ãƒã‚§ãƒƒã‚¯
if [ "$1" = "--help" ] || [ "$1" = "-h" ]; then
    echo "ğŸ›ï¸  ai-elder - Elders Guild Enhanced Claude CLI"
    echo ""
    echo "ä½¿ç”¨æ–¹æ³•:"
    echo "  ai-elder cast              ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰çŸ¥è­˜ä»˜ãClaudeèµ·å‹•ï¼ˆæ¨å¥¨ï¼‰"
    echo "  ai-elder cast [prompt]     ç‰¹å®šãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§èµ·å‹•"
    echo "  ai-elder status            ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ç¢ºèª"
    echo "  ai-elder knowledge         CLAUDE.mdçŸ¥è­˜ç¢ºèª"
    echo "  ai-elder test              èµ·å‹•ãƒ•ãƒƒã‚¯å˜ä½“ãƒ†ã‚¹ãƒˆ"
    echo "  ai-elder old [args]        æ—§ai-elderã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ"
    echo ""
    echo "ğŸ§™â€â™‚ï¸ Elders Guild Features:"
    echo "  â€¢ CLAUDE.mdè‡ªå‹•èª­ã¿è¾¼ã¿"
    echo "  â€¢ ã‚¯ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ«ãƒ€ãƒ¼ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£"
    echo "  â€¢ 4è³¢è€…ã‚·ã‚¹ãƒ†ãƒ çŸ¥è­˜"
    echo "  â€¢ CO-STARãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯"
    echo "  â€¢ TDDé–‹ç™ºåŸå‰‡"
    echo ""
    echo "ä¾‹:"
    echo "  ai-elder cast                    # å¯¾è©±å¼ã§èµ·å‹•"
    echo "  ai-elder cast 'TDDã§æ–°æ©Ÿèƒ½ä½œæˆ'   # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæŒ‡å®š"
    echo "  ai-elder old council status      # æ—§æ©Ÿèƒ½ä½¿ç”¨"
    exit 0
fi

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆç§»å‹•
cd /home/aicompany/ai_co

# ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰å‡¦ç†
case "$1" in
    "cast")
        echo "ğŸ§™â€â™‚ï¸ Elder Casting - Summoning Claude with Elders Guild Knowledge..."
        shift  # 'cast'ã‚’å¼•æ•°ã‹ã‚‰é™¤å»
        exec /home/aicompany/ai_co/claude-enhanced "$@"
        ;;
    "status")
        echo "ğŸ›ï¸  Elders Guild System Status"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "ğŸ“ Project Root: $(pwd)"
        echo "ğŸ“„ CLAUDE.md: $([ -f CLAUDE.md ] && echo 'âœ… Present' || echo 'âŒ Missing')"
        echo "ğŸ”§ claude-enhanced: $([ -x claude-enhanced ] && echo 'âœ… Executable' || echo 'âŒ Missing')"
        echo "ğŸ“š Startup Hook: $([ -f claude_startup_hook.js ] && echo 'âœ… Present' || echo 'âŒ Missing')"
        echo "ğŸ§™â€â™‚ï¸ Knowledge Base: $([ -d knowledge_base ] && echo "âœ… $(ls knowledge_base | wc -l) files" || echo 'âŒ Missing')"
        echo ""
        echo "ğŸ¯ Quick Test:"
        node claude_startup_hook.js 2>/dev/null && echo "âœ… Startup hook working" || echo "âŒ Startup hook failed"
        ;;
    "knowledge")
        echo "ğŸ“š CLAUDE.md Knowledge Check"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        if [ -f CLAUDE.md ]; then
            echo "ğŸ“Š File Size: $(du -h CLAUDE.md | cut -f1)"
            echo "ğŸ“ Lines: $(wc -l < CLAUDE.md)"
            echo ""
            echo "ğŸ” Key Sections Detected:"
            grep -E "^##\s+" CLAUDE.md | head -10
            echo ""
            echo "ğŸ§™â€â™‚ï¸ Testing Knowledge Extraction:"
            node claude_startup_hook.js | grep "Sections loaded"
        else
            echo "âŒ CLAUDE.md not found in current directory"
        fi
        ;;
    "test")
        echo "ğŸ§ª Testing Elders Guild Startup Hook"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        node claude_startup_hook.js
        echo ""
        echo "Environment Variables Set:"
        env | grep CLAUDE_ || echo "No CLAUDE_* environment variables found"
        ;;
    "old")
        echo "ğŸ”„ Executing legacy ai-elder command..."
        shift  # 'old'ã‚’å¼•æ•°ã‹ã‚‰é™¤å»
        exec /home/aicompany/ai_co/ai-elder-old "$@"
        ;;
    *)
        echo "ğŸ›ï¸  AI Elder - Elders Guild Enhanced Claude CLI"
        echo ""
        echo "ä½¿ç”¨æ–¹æ³•: ai-elder <command>"
        echo ""
        echo "ä¸»è¦ã‚³ãƒãƒ³ãƒ‰:"
        echo "  cast       ğŸ§™â€â™‚ï¸ ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰çŸ¥è­˜ä»˜ãã§Claudeèµ·å‹•ï¼ˆæ¨å¥¨ï¼‰"
        echo "  status     ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ç¢ºèª"
        echo "  knowledge  ğŸ“š CLAUDE.mdçŸ¥è­˜ç¢ºèª"
        echo "  test       ğŸ§ª èµ·å‹•ãƒ•ãƒƒã‚¯å˜ä½“ãƒ†ã‚¹ãƒˆ"
        echo "  old        ğŸ”„ æ—§ai-elderã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ"
        echo ""
        echo "è©³ç´°: ai-elder --help"
        echo ""
        echo "ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ: ai-elder cast"
        ;;
esac