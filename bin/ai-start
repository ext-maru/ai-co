#!/bin/bash

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³è§£æ
START_WEB=false
while [[ $# -gt 0 ]]; do
    case $1 in
        --web)
            START_WEB=true
            shift
            ;;
        --help|-h)
            echo "AI Company èµ·å‹•ã‚³ãƒãƒ³ãƒ‰"
            echo ""
            echo "ä½¿ç”¨æ–¹æ³•:"
            echo "  ai-start [ã‚ªãƒ—ã‚·ãƒ§ãƒ³]"
            echo ""
            echo "ã‚ªãƒ—ã‚·ãƒ§ãƒ³:"
            echo "  --web     Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚‚åŒæ™‚ã«èµ·å‹•"
            echo "  --help    ã“ã®ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º"
            exit 0
            ;;
        *)
            echo "æœªçŸ¥ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³: $1"
            echo "ãƒ˜ãƒ«ãƒ—: ai-start --help"
            exit 1
            ;;
    esac
done

echo "ğŸ¢ AI Company ã‚’èµ·å‹•ä¸­..."
cd /home/aicompany/ai_co
if tmux has-session -t ai_company 2>/dev/null; then
    echo "âš ï¸  æ—¢ã«AI CompanyãŒèµ·å‹•ã—ã¦ã„ã¾ã™"
    exit 0
fi

# ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’èµ·å‹•
bash scripts/start_company.sh

# Webã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆ
if [ "$START_WEB" = true ]; then
    echo "ğŸŒ Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’èµ·å‹•ä¸­..."
    tmux new-window -t ai_company -n "webui"
    tmux send-keys -t ai_company:webui "cd $PWD && source venv/bin/activate" C-m
    tmux send-keys -t ai_company:webui "python3 web/dashboard_server.py" C-m
    echo "âœ… Webãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰èµ·å‹•å®Œäº†ï¼"
    echo "ğŸŒ ã‚¢ã‚¯ã‚»ã‚¹: http://localhost:5555"
fi
