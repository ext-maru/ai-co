#!/bin/bash
# Enhanced Claude CLI with CLAUDE.md Auto-loading
# ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰å°‚ç”¨ Claude CLI ãƒ©ãƒƒãƒ‘ãƒ¼

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆè¨­å®š
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

# CLAUDE.mdè‡ªå‹•èª­ã¿è¾¼ã¿
echo "ğŸ›ï¸  Initializing Elders Guild Claude CLI..."

# Node.js ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ãƒ•ãƒƒã‚¯ã®å®Ÿè¡Œ
if [ -f "claude_startup_hook.js" ]; then
    echo "ğŸ“š Loading CLAUDE.md knowledge..."
    node claude_startup_hook.js
    HOOK_EXIT_CODE=$?
    
    if [ $HOOK_EXIT_CODE -eq 0 ]; then
        echo "âœ… Knowledge loaded successfully"
    else
        echo "âš ï¸  Warning: Could not load CLAUDE.md knowledge"
    fi
else
    echo "âš ï¸  Warning: claude_startup_hook.js not found"
fi

# ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰ç’°å¢ƒå¤‰æ•°è¨­å®š
export CLAUDE_ELDERS_GUILD="active"
export CLAUDE_PROJECT_ROOT="$SCRIPT_DIR"
export CLAUDE_KNOWLEDGE_BASE="$SCRIPT_DIR/knowledge_base"

# èµ·å‹•ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
echo ""
echo "ğŸ¤– Claude Elder Starting..."
echo "ğŸ“ Project: $(basename "$SCRIPT_DIR")"
echo "ğŸ“š Knowledge: Elders Guild Active"
echo "ğŸ› ï¸  Commands: ai-* available"
echo ""

# æ—¢å­˜ã®å¼•æ•°ã‚’ã™ã¹ã¦Claude CLIã«è»¢é€
if [ $# -eq 0 ]; then
    # å¼•æ•°ãªã—ã®å ´åˆã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ï¼ˆdangerousã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
    echo "Starting interactive Claude session with Elders Guild knowledge..."
    echo "Type your first message or 'help' for available commands."
    echo ""
    claude --dangerously-skip-permissions
else
    # å¼•æ•°ã‚ã‚Šã®å ´åˆã€ãã®ã¾ã¾è»¢é€ï¼ˆdangerousã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
    claude --dangerously-skip-permissions "$@"
fi