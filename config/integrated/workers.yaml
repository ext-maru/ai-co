# ğŸ‘· Worker Configuration
# çµ±åˆè¨­å®šã‚·ã‚¹ãƒ†ãƒ  - ãƒ¯ãƒ¼ã‚«ãƒ¼è¨­å®š
# å…¨ãƒ¯ãƒ¼ã‚«ãƒ¼ã®çµ±ä¸€ç®¡ç†

# å…±é€šè¨­å®š
common:
  timeout: 300
  retry_count: 3
  retry_delay: 60
  max_workers: 4
  min_workers: 1

# RabbitMQè¨­å®š
rabbitmq:
  host: "localhost"
  port: 5672
  user: "guest"
  password: "guest"
  heartbeat: 600
  blocked_connection_timeout: 300

# Redisè¨­å®š
redis:
  url: "redis://localhost:6379/0"

# ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°è¨­å®š
scaling:
  enabled: true
  check_interval: 60
  scale_up_threshold: 0.8
  scale_down_threshold: 0.3
  auto_scaling: true

# å€‹åˆ¥ãƒ¯ãƒ¼ã‚«ãƒ¼è¨­å®š
workers:
  enhanced_task_worker:
    enabled: true
    critical: true
    script: "/home/aicompany/ai_co/workers/enhanced_task_worker.py"

    # Claude APIè¨­å®š
    claude:
      model: "claude-sonnet-4-20250514"
      max_tokens: 4096
      temperature: 0.7
      timeout: 300
      rate_limit: 10

    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
    security:
      sandbox_base: "/tmp/ai_sandbox"
      memory_limit_mb: 512
      execution_timeout: 300

    # è¨±å¯ãƒ„ãƒ¼ãƒ«
    allowed_tools:
      - "Edit"
      - "Write"
      - "Read"
      - "FileSystem"
      - "Bash"

    # ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
    cache:
      ttl: 3600
      enabled: true

    # RAGè¨­å®š
    rag:
      enabled: true

    # å‡ºåŠ›è¨­å®š
    output:
      dir: "/home/aicompany/ai_co/output"

    # é€šçŸ¥è¨­å®š
    notifications:
      slack_enabled: true

  async_result_worker:
    enabled: true
    critical: true
    script: "/home/aicompany/ai_co/workers/async_result_worker_simple.py"

    # Slackè¨­å®š
    slack:
      rate_limit: 1
      max_message_size: 3000

    # çµ±è¨ˆè¨­å®š
    stats:
      file: "/home/aicompany/ai_co/data/result_worker_stats.json"
      report_interval_hours: 1

    # ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
    cache:
      ttl: 86400

    # ãƒªãƒˆãƒ©ã‚¤è¨­å®š
    retry:
      failed_notifications: true
      max_attempts: 3
      delay: 300

  intelligent_pm_worker:
    enabled: true
    critical: true
    script: "/home/aicompany/ai_co/workers/intelligent_pm_worker_simple.py"

    # ãƒ¡ãƒ¢ãƒªç®¡ç†
    memory:
      max_mb: 1024
      cleanup_threshold: 0.8

    # ä¸¦åˆ—å‡¦ç†
    parallel:
      max_concurrent_tasks: 5

    # ãƒ•ã‚§ãƒ¼ã‚ºè¨­å®š
    phase:
      timeout: 600

    # ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ
    checkpoint:
      retention_hours: 24

    # ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
    cache:
      ttl: 3600

  dialog_task_worker:
    enabled: true
    critical: false
    script: "/home/aicompany/ai_co/workers/dialog_task_worker.py"

    # ä¼šè©±è¨­å®š
    conversation:
      max_turns: 50
      timeout: 1800

    # ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
    cache:
      ttl: 7200

  error_intelligence_worker:
    enabled: true
    critical: false
    script: "/home/aicompany/ai_co/workers/error_intelligence_worker.py"

    # åˆ†æè¨­å®š
    analysis:
      max_batch_size: 10
      deduplication: true

    # ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆè¨­å®š
    incident:
      threshold: 3
      ttl: 86400

  slack_polling_worker:
    enabled: true
    critical: false
    script: "/home/aicompany/ai_co/workers/slack_polling_worker.py"

# è‡ªå‹•å›å¾©è¨­å®š
recovery:
  enabled: true
  check_interval: 30
  max_retries: 3
  retry_delay: 10
  cooldown_period: 300

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯è¨­å®š
health_check:
  enabled: true
  interval: 30
  timeout: 10

  # é–¾å€¤è¨­å®š
  thresholds:
    cpu_percent: 90.0
    memory_mb: 1024
    error_rate: 0.1
    queue_size: 100
    response_timeout: 30

  # å±¥æ­´è¨­å®š
  history_size: 100

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
security:
  # è¨±å¯ã‚³ãƒãƒ³ãƒ‰
  allowed_commands:
    - "python"
    - "python3"
    - "node"
    - "npm"
    - "bash"
    - "sh"
    - "git"
    - "pip"
    - "pytest"
    - "ruff"
    - "black"
    - "mypy"
    - "ls"
    - "cat"
    - "echo"
    - "grep"
    - "find"
    - "sed"
    - "awk"

  # ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³
  forbidden_patterns:
    - 'rm\s+-rf\s+/'
    - 'sudo'
    - 'chmod\s+777'
    - 'eval\s*\('
    - 'exec\s*\('
    - '__import__'
    - 'os\.system'
    - 'subprocess\.call'
    - 'curl.*\|.*sh'
    - 'wget.*\|.*sh'
    - 'dd\s+if=/dev/zero'
    - ':(){ :|:& };:'
    - '>\s*/dev/sd'
    - 'mkfs\.'
    - 'fdisk'

  # ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹è¨­å®š
  sandbox:
    cleanup_hours: 24
    max_size_mb: 1000

# ç›£è¦–è¨­å®š
monitoring:
  enabled: true

  # ãƒ˜ãƒ«ã‚¹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
  health_endpoints:
    - "/health"
    - "/ready"

  # ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
  metrics_endpoints:
    - "/metrics"

  # ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š
  alerts:
    memory_threshold: 90
    error_rate_threshold: 5
    response_time_threshold: 30
    queue_length_threshold: 1000

# ç’°å¢ƒåˆ¥è¨­å®š
environments:
  development:
    debug_mode: false
    verbose_logging: false
    test_mode: false
    mock_external_services: false

  production:
    auto_scaling: true
    min_workers: 2
    max_workers: 10
    backup_enabled: true
    backup_interval_hours: 6
    monitoring_enabled: true
    alerting_enabled: true
