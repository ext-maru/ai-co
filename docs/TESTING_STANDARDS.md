# ğŸ§ª Elders Guild ãƒ†ã‚¹ãƒˆæ¨™æº–è¦ç´„ v1.0

## ğŸ“‹ æ¦‚è¦

Elders Guildã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã«é©ç”¨ã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆæ¨™æº–è¦ç´„ã§ã™ã€‚æ–°è¦ä½œæˆãƒ»æ—¢å­˜ã‚³ãƒ¼ãƒ‰ä¿®æ­£æ™‚ã¯å¿…ãšã“ã®è¦ç´„ã«å¾“ã£ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ãƒ»å®Ÿè¡Œã—ã¾ã™ã€‚

## ğŸ¯ ãƒ†ã‚¹ãƒˆã®åŸºæœ¬åŸå‰‡

### 1. ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆé–‹ç™º
- ã‚³ãƒ¼ãƒ‰å¤‰æ›´å‰ã«ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’å®šç¾©
- å®Ÿè£…å¾Œã¯å¿…ãšãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
- ãƒ†ã‚¹ãƒˆãªã—ã®ã‚³ãƒ¼ãƒ‰ã¯ãƒãƒ¼ã‚¸ã—ãªã„

### 2. ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™
- **Core modules**: 90%ä»¥ä¸Š
- **Workers**: 80%ä»¥ä¸Š
- **Managers**: 80%ä»¥ä¸Š
- **Utilities**: 70%ä»¥ä¸Š

### 3. ãƒ†ã‚¹ãƒˆã®ç¨®é¡

| ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ— | ç›®çš„ | å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚° | æ‰€è¦æ™‚é–“ |
|------------|-----|--------------|---------|
| Unit Test | å€‹åˆ¥æ©Ÿèƒ½ã®æ¤œè¨¼ | ã‚³ãƒ¼ãƒ‰å¤‰æ›´æ™‚ | < 1ç§’/test |
| Integration Test | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé€£æº | PRä½œæˆæ™‚ | < 10ç§’/test |
| E2E Test | å…¨ä½“ãƒ•ãƒ­ãƒ¼æ¤œè¨¼ | ãƒªãƒªãƒ¼ã‚¹å‰ | < 5åˆ† |
| Performance Test | æ€§èƒ½æ¤œè¨¼ | é€±æ¬¡ | < 30åˆ† |

## ğŸ—‚ï¸ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
/home/aicompany/ai_co/
â”œâ”€â”€ tests/                      # ãƒ¡ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ unit/                  # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ test_workers/     # ãƒ¯ãƒ¼ã‚«ãƒ¼ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ test_managers/    # ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â””â”€â”€ test_core/        # ã‚³ã‚¢ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ integration/           # çµ±åˆãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ e2e/                  # E2Eãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ fixtures/             # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â”‚   â””â”€â”€ conftest.py          # pytestè¨­å®š
â”œâ”€â”€ test_utils/               # ãƒ†ã‚¹ãƒˆç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â””â”€â”€ .coverage                # ã‚«ãƒãƒ¬ãƒƒã‚¸è¨­å®š
```

## ğŸ“ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡

```python
# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
test_<module_name>.py           # ä¾‹: test_task_worker.py

# çµ±åˆãƒ†ã‚¹ãƒˆ
test_integration_<feature>.py   # ä¾‹: test_integration_rag_flow.py

# E2Eãƒ†ã‚¹ãƒˆ
test_e2e_<scenario>.py         # ä¾‹: test_e2e_code_generation.py

# ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹
class Test<ComponentName>:      # ä¾‹: class TestTaskWorker:

# ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰
def test_<action>_<expected>(): # ä¾‹: def test_process_message_success():
```

## ğŸ”§ å¿…é ˆãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

### 1. ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ†ã‚¹ãƒˆ

```python
class TestWorker:
    """ã™ã¹ã¦ã®ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒå®Ÿè£…ã™ã¹ããƒ†ã‚¹ãƒˆ"""

    def test_initialization(self):
        """åˆæœŸåŒ–ãŒæ­£å¸¸ã«å®Œäº†ã™ã‚‹ã“ã¨"""

    def test_rabbitmq_connection(self):
        """RabbitMQæ¥ç¶šãŒç¢ºç«‹ã§ãã‚‹ã“ã¨"""

    def test_process_message_success(self):
        """æ­£å¸¸ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡¦ç†ã§ãã‚‹ã“ã¨"""

    def test_process_message_invalid_json(self):
        """ä¸æ­£ãªJSONã‚’é©åˆ‡ã«å‡¦ç†ã™ã‚‹ã“ã¨"""

    def test_error_handling(self):
        """ã‚¨ãƒ©ãƒ¼ãŒé©åˆ‡ã«ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã“ã¨"""

    def test_graceful_shutdown(self):
        """ã‚°ãƒ¬ãƒ¼ã‚¹ãƒ•ãƒ«ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ãŒå‹•ä½œã™ã‚‹ã“ã¨"""
```

### 2. ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ†ã‚¹ãƒˆ

```python
class TestManager:
    """ã™ã¹ã¦ã®ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒå®Ÿè£…ã™ã¹ããƒ†ã‚¹ãƒˆ"""

    def test_initialization(self):
        """åˆæœŸåŒ–ãŒæ­£å¸¸ã«å®Œäº†ã™ã‚‹ã“ã¨"""

    def test_configuration_loading(self):
        """è¨­å®šãŒæ­£ã—ãèª­ã¿è¾¼ã¾ã‚Œã‚‹ã“ã¨"""

    def test_main_functionality(self):
        """ä¸»è¦æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹ã“ã¨"""

    def test_error_recovery(self):
        """ã‚¨ãƒ©ãƒ¼ã‹ã‚‰ã®å¾©æ—§ãŒå¯èƒ½ãªã“ã¨"""
```

### 3. çµ±åˆãƒ†ã‚¹ãƒˆ

```python
class TestIntegration:
    """ãƒ¯ãƒ¼ã‚«ãƒ¼é–“ã®é€£æºãƒ†ã‚¹ãƒˆ"""

    def test_task_to_pm_flow(self):
        """TaskWorkerâ†’PMWorkerã®ãƒ•ãƒ­ãƒ¼ãŒå‹•ä½œã™ã‚‹ã“ã¨"""

    def test_complete_task_flow(self):
        """ã‚¿ã‚¹ã‚¯é€ä¿¡ã‹ã‚‰å®Œäº†é€šçŸ¥ã¾ã§ã®å…¨ãƒ•ãƒ­ãƒ¼ãŒå‹•ä½œã™ã‚‹ã“ã¨"""

    def test_error_propagation(self):
        """ã‚¨ãƒ©ãƒ¼ãŒé©åˆ‡ã«ä¼æ’­ã™ã‚‹ã“ã¨"""
```

## ğŸ¨ ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰è¨˜è¿°æ¨™æº–

### 1. AAAåŸå‰‡ï¼ˆArrange-Act-Assertï¼‰

```python
def test_task_processing():
    # Arrangeï¼ˆæº–å‚™ï¼‰
    worker = TaskWorker()
    test_task = {"task_id": "test_123", "prompt": "test prompt"}

    # Actï¼ˆå®Ÿè¡Œï¼‰
    result = worker.process_task(test_task)

    # Assertï¼ˆæ¤œè¨¼ï¼‰
    assert result["status"] == "completed"
    assert "response" in result
```

### 2. ãƒ¢ãƒƒã‚¯ã®ä½¿ç”¨

```python
from unittest.mock import Mock, patch

@patch('pika.BlockingConnection')
def test_with_mock_connection(mock_conn):
    # RabbitMQæ¥ç¶šã‚’ãƒ¢ãƒƒã‚¯åŒ–
    mock_conn.return_value = Mock()
    worker = TaskWorker()
    assert worker.connection is not None
```

### 3. ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã®æ´»ç”¨

```python
import pytest

@pytest.fixture
def sample_task():
    """ãƒ†ã‚¹ãƒˆç”¨ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿"""
    return {
        "task_id": "test_123",
        "task_type": "code",
        "prompt": "Create a test function"
    }

def test_with_fixture(sample_task):
    result = process_task(sample_task)
    assert result is not None
```

## ğŸš€ è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

### 1. ãƒ—ãƒ¬ã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯

```bash
# .git/hooks/pre-commit
#!/bin/bash
# å¤‰æ›´ã•ã‚ŒãŸPythonãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
python -m pytest tests/unit/ -v --tb=short
```

### 2. CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```yaml
# .github/workflows/test.yml
name: Elders Guild Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Run Unit Tests
        run: pytest tests/unit/ --cov=.
      - name: Run Integration Tests
        run: pytest tests/integration/
      - name: Check Coverage
        run: pytest --cov=. --cov-report=html --cov-fail-under=80
```

## ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ¡ãƒˆãƒªã‚¯ã‚¹

### å¿…é ˆãƒ¡ãƒˆãƒªã‚¯ã‚¹
- ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡
- ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“
- å¤±æ•—ç‡
- ãƒ•ãƒ¬ãƒ¼ã‚¯ã‚£ãƒã‚¹ï¼ˆä¸å®‰å®šãªãƒ†ã‚¹ãƒˆã®å‰²åˆï¼‰

### ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ
pytest --cov=. --cov-report=html

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆçµæœ
pytest tests/performance/ --benchmark-only

# ãƒ†ã‚¹ãƒˆçµ±è¨ˆ
ai-test-report generate
```

## ğŸ”„ ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºãƒ•ãƒ­ãƒ¼

1. **è¦ä»¶å®šç¾©** â†’ ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä½œæˆ
2. **ãƒ†ã‚¹ãƒˆä½œæˆ** â†’ å¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆRedï¼‰
3. **å®Ÿè£…** â†’ ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆGreenï¼‰
4. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°** â†’ ãƒ†ã‚¹ãƒˆãŒé€šã‚Šç¶šã‘ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆRefactorï¼‰
5. **çµ±åˆãƒ†ã‚¹ãƒˆ** â†’ ä»–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã®é€£æºç¢ºèª
6. **ãƒ‡ãƒ—ãƒ­ã‚¤** â†’ æœ¬ç•ªç’°å¢ƒã§ã®ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ

## ğŸ¯ ãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æ–°è¦ã‚³ãƒ¼ãƒ‰ä½œæˆæ™‚
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’ä½œæˆã—ãŸ
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šã‚’é”æˆã—ãŸ
- [ ] ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆã—ãŸ
- [ ] å¢ƒç•Œå€¤ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ãŸ
- [ ] ãƒ¢ãƒƒã‚¯ã‚’é©åˆ‡ã«ä½¿ç”¨ã—ãŸ

### æ—¢å­˜ã‚³ãƒ¼ãƒ‰ä¿®æ­£æ™‚
- [ ] æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸ
- [ ] ä¿®æ­£ã«å¯¾å¿œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ãŸ
- [ ] ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ãŸ
- [ ] å½±éŸ¿ç¯„å›²ã®çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ãŸ

### ãƒªãƒªãƒ¼ã‚¹å‰
- [ ] å…¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆãŒé€šéã—ãŸ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã§åŠ£åŒ–ãŒãªã„
- [ ] E2Eãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ãŸ
- [ ] ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ãŸ

## ğŸ› ï¸ ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«

### å¿…é ˆãƒ„ãƒ¼ãƒ«
- **pytest**: ãƒ¡ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **pytest-cov**: ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š
- **pytest-mock**: ãƒ¢ãƒƒã‚¯æ©Ÿèƒ½
- **pytest-benchmark**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
- **pytest-xdist**: ä¸¦åˆ—å®Ÿè¡Œ

### è£œåŠ©ãƒ„ãƒ¼ãƒ«
- **factory_boy**: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
- **freezegun**: æ™‚åˆ»å›ºå®š
- **responses**: HTTPãƒ¢ãƒƒã‚¯
- **pytest-timeout**: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š

## ğŸ“ ãƒ†ã‚¹ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¨˜è¿°

```python
def test_critical_functionality():
    """
    é‡è¦æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

    Given: æ­£å¸¸ãªè¨­å®šã¨ãƒ‡ãƒ¼ã‚¿
    When: process_critical_task()ã‚’å®Ÿè¡Œ
    Then: æœŸå¾…ã•ã‚Œã‚‹çµæœãŒè¿”ã•ã‚Œã‚‹

    ãƒ†ã‚¹ãƒˆID: TC001
    é‡è¦åº¦: Critical
    ã‚«ãƒ†ã‚´ãƒª: Coreæ©Ÿèƒ½
    """
```

### ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸

å„æ©Ÿèƒ½ã«å¯¾ã—ã¦ä»¥ä¸‹ã‚’è¨˜è¼‰ï¼š
1. ãƒ†ã‚¹ãƒˆå¯¾è±¡
2. ãƒ†ã‚¹ãƒˆæ¡ä»¶
3. æœŸå¾…çµæœ
4. å®Ÿè¡Œæ‰‹é †
5. ç¢ºèªé …ç›®

---

**ğŸ§ª ã“ã®è¦ç´„ã«ã‚ˆã‚Šã€Elders Guildã¯é«˜å“è³ªã§ä¿¡é ¼æ€§ã®é«˜ã„ã‚·ã‚¹ãƒ†ãƒ ã‚’ç¶­æŒã—ã¾ã™**
