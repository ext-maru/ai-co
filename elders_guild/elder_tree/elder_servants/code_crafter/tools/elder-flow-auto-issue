#!/usr/bin/env python3
"""
ğŸŒŠ Elder Flow Auto Issue Processor
å„ªå…ˆåº¦ä¸­ã¾ã§ã®GitHubã‚¤ã‚·ãƒ¥ãƒ¼ã‚’è‡ªå‹•çš„ã«Elder Flowã§å‡¦ç†
"""

import asyncio
import os
import sys

sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

import json
from datetime import datetime

from libs.elder_system.flow.elder_flow_engine import ElderFlowEngine
from libs.integrations.github.elders_issue_manager import EldersIssueManager


async def main():
    """ãƒ¡ã‚¤ãƒ³å‡¦ç†"""
    print("ğŸ¤– Auto Issue Processor èµ·å‹•ä¸­...")

    # Elder FlowåˆæœŸåŒ–
    elder_flow = ElderFlowEngine()

    # GitHub Issue ManageråˆæœŸåŒ–
    issue_manager = EldersIssueManager()

    # å‡¦ç†å¯¾è±¡ã®å„ªå…ˆåº¦
    target_priorities = ["medium", "low"]

    # å®Ÿè£…è¨­è¨ˆæ›¸ã®å†…å®¹ã‚’èª­ã¿è¾¼ã‚“ã§å®Ÿè¡Œ
    design_path = "/home/aicompany/ai_co/docs/AUTO_ISSUE_PROCESSOR_DESIGN.md"
    if os.path.exists(design_path):
        print("ğŸ“‹ å®Ÿè£…è¨­è¨ˆæ›¸ã‚’èª­ã¿è¾¼ã‚“ã§Elder Flowå®Ÿè¡Œ...")

        # Elder Flowã§å®Ÿè£…
        result = await elder_flow.execute_flow(
            {
                "task_name": "ã‚¤ã‚·ãƒ¥ãƒ¼è‡ªå‹•å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…",
                "priority": "high",
                "context": {
                    "design_document": design_path,
                    "target_file": "libs/integrations/github/auto_issue_processor.py",
                },
            }
        )

        print(f"âœ… Elder Flowå®Œäº†: {result}")
    else:
        print("âŒ å®Ÿè£…è¨­è¨ˆæ›¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")


if __name__ == "__main__":
    asyncio.run(main())
