# ğŸ›ï¸ ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰ å“è³ªé€²åŒ–äºˆè¨€æ›¸
# å“è³ªã‚’æ®µéšçš„ã«è‡ªå‹•é€²åŒ–ã•ã›ã‚‹äºˆè¨€æ›¸

prophecy_name: "quality_evolution"
description: "å“è³ªã‚’æ®µéšçš„ã«è‡ªå‹•é€²åŒ–ã•ã›ã‚‹äºˆè¨€æ›¸"
category: "quality"
version: "1.0"
author: "Claude Elder"
created_at: "2025-07-11T00:00:00"
updated_at: "2025-07-11T00:00:00"

phases:
  - phase_id: 1
    name: "åŸºæœ¬å“è³ªãƒ•ã‚§ãƒ¼ã‚º"
    description: "åŸºæœ¬çš„ãªå“è³ªãƒã‚§ãƒƒã‚¯ã¨Pre-commitè¨­å®š"
    features:
      - "åŸºæœ¬çš„ãªæ§‹æ–‡ãƒã‚§ãƒƒã‚¯"
      - "YAMLãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼"
      - "å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«æ¤œå‡º"
      - "ãƒãƒ¼ã‚¸ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆæ¤œå‡º"
    requirements:
      - "Pre-commitè¨­å®šæ¸ˆã¿"
      - "Gitè¨­å®šå®Œäº†"
    gates:
      - gate_id: "quality_gate_1"
        target_phase: 2
        description: "åŸºæœ¬å“è³ªã‹ã‚‰ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¸ã®æ˜‡æ ¼"
        criteria:
          - precommit_success_rate: ">= 95"
          - precommit_avg_time: "<= 3.0"
          - python_syntax_errors: "== 0"
          - team_satisfaction: ">= 80"
          - tool_understanding_black: ">= 75"
          - developer_complaints: "<= 3"
        evolution_actions:
          - "add_black_formatter"
          - "add_isort_import_sorter"
          - "enable_code_formatting"
          - "update_precommit_config_phase_2"
        stability_days: 7
        trigger: "automatic"

  - phase_id: 2
    name: "ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ•ã‚§ãƒ¼ã‚º"
    description: "Black + isort ã«ã‚ˆã‚‹è‡ªå‹•ã‚³ãƒ¼ãƒ‰æ•´å½¢"
    features:
      - "è‡ªå‹•ã‚³ãƒ¼ãƒ‰æ•´å½¢ (Black)"
      - "Importé †åºè‡ªå‹•ä¿®æ­£ (isort)"
      - "çµ±ä¸€ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«"
      - "ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé•åã®è‡ªå‹•ä¿®æ­£"
    requirements:
      - "Blackç†è§£ã¨ãƒ„ãƒ¼ãƒ«ç¿’ç†Ÿ"
      - "isortè¨­å®šã®ç†è§£"
    gates:
      - gate_id: "quality_gate_2"
        target_phase: 3
        description: "ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰å“è³ªå¼·åŒ–ã¸ã®æ˜‡æ ¼"
        criteria:
          - black_compliance_rate: ">= 95"
          - import_order_compliance: ">= 95"
          - pr_creation_time_reduction: ">= 30"
          - code_review_time_reduction: ">= 20"
          - team_satisfaction: ">= 85"
          - format_related_issues: "== 0"
        evolution_actions:
          - "add_flake8_linter"
          - "add_bandit_security_scanner"
          - "enable_code_complexity_checks"
          - "update_precommit_config_phase_3"
        stability_days: 14
        trigger: "automatic"

  - phase_id: 3
    name: "å“è³ªå¼·åŒ–ãƒ•ã‚§ãƒ¼ã‚º"
    description: "Flake8 + Bandit ã«ã‚ˆã‚‹å“è³ªãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–"
    features:
      - "ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ (Flake8)"
      - "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§æ¤œå‡º (Bandit)"
      - "è¤‡é›‘åº¦ãƒã‚§ãƒƒã‚¯"
      - "ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„å¼·åˆ¶"
    requirements:
      - "Flake8ãƒ«ãƒ¼ãƒ«ã®ç†è§£"
      - "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ„è­˜ã®å‘ä¸Š"
    gates:
      - gate_id: "quality_gate_3"
        target_phase: 4
        description: "å“è³ªå¼·åŒ–ã‹ã‚‰TDDå®Œå…¨ã¸ã®æ˜‡æ ¼"
        criteria:
          - code_quality_score: ">= 9.0"
          - security_issues_count: "== 0"
          - flake8_violations: "<= 5"
          - test_coverage: ">= 70"
          - tdd_understanding_score: ">= 80"
          - bug_reduction_rate: ">= 50"
        evolution_actions:
          - "add_mypy_type_checking"
          - "add_pytest_coverage_enforcement"
          - "enable_tdd_compliance_checks"
          - "update_precommit_config_phase_4"
        stability_days: 21
        trigger: "elder_council"  # Phase 4ã¯æ…é‡ã«æ‰‹å‹•æ‰¿èª

  - phase_id: 4
    name: "TDDå®Œå…¨ãƒ•ã‚§ãƒ¼ã‚º"
    description: "å®Œå…¨ãªTDDæº–æ‹ ã¨ã‚¿ã‚¤ãƒ—ãƒã‚§ãƒƒã‚¯"
    features:
      - "å®Œå…¨ãªå‹ãƒã‚§ãƒƒã‚¯ (mypy)"
      - "ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸å¼·åˆ¶"
      - "TDDæº–æ‹ ãƒã‚§ãƒƒã‚¯"
      - "å®Œå…¨å“è³ªä¿è¨¼"
    requirements:
      - "TDDå®Œå…¨ç†è§£"
      - "å‹ãƒ’ãƒ³ãƒˆå®Œå…¨å¯¾å¿œ"
      - "ãƒ†ã‚¹ãƒˆè¨­è¨ˆã‚¹ã‚­ãƒ«"
    gates: []  # æœ€çµ‚ãƒ•ã‚§ãƒ¼ã‚ºã®ãŸã‚æ˜‡æ ¼ã‚²ãƒ¼ãƒˆãªã—

# ğŸ“Š ãƒ¡ãƒˆãƒªã‚¯ã‚¹å®šç¾©
metrics:
  precommit_success_rate:
    description: "Pre-commitå®Ÿè¡ŒæˆåŠŸç‡"
    unit: "percentage"
    collection_method: "git_log_analysis"

  precommit_avg_time:
    description: "Pre-commitå¹³å‡å®Ÿè¡Œæ™‚é–“"
    unit: "seconds"
    collection_method: "execution_timing"

  python_syntax_errors:
    description: "Pythonæ§‹æ–‡ã‚¨ãƒ©ãƒ¼æ•°"
    unit: "count"
    collection_method: "syntax_check"

  team_satisfaction:
    description: "ãƒãƒ¼ãƒ æº€è¶³åº¦"
    unit: "percentage"
    collection_method: "survey"

  tool_understanding_black:
    description: "Blackãƒ„ãƒ¼ãƒ«ç†è§£åº¦"
    unit: "percentage"
    collection_method: "skill_assessment"

  developer_complaints:
    description: "é–‹ç™ºè€…è‹¦æƒ…æ•°"
    unit: "count"
    collection_method: "feedback_tracking"

# ğŸ”§ é€²åŒ–ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®šç¾©
evolution_actions:
  add_black_formatter:
    description: "Blackè‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã‚’è¿½åŠ "
    type: "config_update"

  add_isort_import_sorter:
    description: "isortã«ã‚ˆã‚‹importé †åºæ•´ç†ã‚’è¿½åŠ "
    type: "config_update"

  enable_code_formatting:
    description: "ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–"
    type: "feature_enable"

  update_precommit_config_phase_2:
    description: "Phase 2ç”¨ã®pre-commitè¨­å®šã«æ›´æ–°"
    type: "config_replacement"

  add_flake8_linter:
    description: "Flake8ãƒªãƒ³ã‚¿ãƒ¼ã‚’è¿½åŠ "
    type: "config_update"

  add_bandit_security_scanner:
    description: "Banditã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã‚’è¿½åŠ "
    type: "config_update"

  enable_code_complexity_checks:
    description: "ã‚³ãƒ¼ãƒ‰è¤‡é›‘åº¦ãƒã‚§ãƒƒã‚¯ã‚’æœ‰åŠ¹åŒ–"
    type: "feature_enable"

  update_precommit_config_phase_3:
    description: "Phase 3ç”¨ã®pre-commitè¨­å®šã«æ›´æ–°"
    type: "config_replacement"

  add_mypy_type_checking:
    description: "mypyå‹ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ "
    type: "config_update"

  add_pytest_coverage_enforcement:
    description: "pytest ã‚«ãƒãƒ¬ãƒƒã‚¸å¼·åˆ¶ã‚’è¿½åŠ "
    type: "config_update"

  enable_tdd_compliance_checks:
    description: "TDDæº–æ‹ ãƒã‚§ãƒƒã‚¯ã‚’æœ‰åŠ¹åŒ–"
    type: "feature_enable"

  update_precommit_config_phase_4:
    description: "Phase 4ç”¨ã®pre-commitè¨­å®šã«æ›´æ–°"
    type: "config_replacement"

# ğŸ¯ äºˆè¨€æ›¸ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
metadata:
  estimated_duration:
    phase_1_to_2: "1-2é€±é–“"
    phase_2_to_3: "2-3é€±é–“"
    phase_3_to_4: "3-4é€±é–“"

  difficulty_level:
    phase_1: "åˆç´š"
    phase_2: "åˆç´š-ä¸­ç´š"
    phase_3: "ä¸­ç´š"
    phase_4: "ä¸Šç´š"

  success_factors:
    - "ãƒãƒ¼ãƒ å…¨ä½“ã®ç†è§£ã¨å”åŠ›"
    - "æ®µéšçš„ãªå­¦ç¿’ã¨é©å¿œ"
    - "ç¶™ç¶šçš„ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯"
    - "é©åˆ‡ãªæ•™è‚²ã¨ã‚µãƒãƒ¼ãƒˆ"

  rollback_triggers:
    - "ã‚¨ãƒ©ãƒ¼ç‡ãŒ10%ã‚’è¶…é"
    - "ãƒãƒ¼ãƒ æº€è¶³åº¦ãŒ60%ã‚’ä¸‹å›ã‚‹"
    - "é‡è¦ãªæ©Ÿèƒ½ã®åœæ­¢"
    - "é–‹ç™ºåŠ¹ç‡ã®å¤§å¹…ãªä½ä¸‹"
