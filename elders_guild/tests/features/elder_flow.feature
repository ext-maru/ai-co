# language: ja

機能: Elder Flow - 5段階自動化ワークフロー
  Elder Flowは5つのステージを通じてタスクを自動実行する
  各ステージは独立して実行可能で、失敗時は適切にハンドリングされる

  背景:
    前提 Elder Flowシステムが起動している
    かつ 4賢者が全て利用可能である
    かつ サーバントが登録されている

  シナリオ: 正常なワークフロー実行
    もし "feature_implementation"タスクを優先度"high"で実行する
    ならば ステージ1の賢者協議が成功する
    かつ ステージ2のサーバント実行が成功する
    かつ ステージ3の品質ゲートを通過する
    かつ ステージ4の評議会報告が生成される
    かつ ステージ5のGit自動化が完了する
    かつ 全体のステータスが"completed"になる

  シナリオ: 賢者協議でのタイムアウト
    もし "complex_analysis"タスクを実行する
    かつ Knowledge Sageが応答しない
    ならば ステージ1が部分的に成功する
    かつ 他の3賢者の結果は取得できる
    かつ ワークフローは継続される

  シナリオ: 品質ゲート失敗
    もし "low_quality_code"タスクを実行する
    かつ 品質スコアが85未満である
    ならば ステージ3で失敗する
    かつ Incident Sageに報告される
    かつ 全体のステータスが"failed"になる

  シナリオ: 並列実行
    もし 複数のタスクを同時に実行する
    ならば 各タスクは独立したフローで処理される
    かつ PIDロックにより重複実行が防止される
    かつ リソースが適切に管理される