# 🏛️ OSS First Development Policy (OSS活用必須開発方針)

**制定日**: 2025年7月22日  
**最終更新**: 2025年7月23日  
**制定者**: エルダー評議会  
**承認者**: グランドエルダー maru様  
**施行**: 即時発効  
**重要度**: Critical（技術負債防止のため）

---

## 📜 **基本方針**

### 🎯 **OSS First原則**
**「車輪の再発明禁止 - 既存OSSを最大限活用せよ」**

1. **既存OSS優先**: 機能実装前に必ず既存OSSを調査
2. **実績重視**: 本番環境で実績のあるライブラリを選択
3. **コミュニティ活用**: アクティブなコミュニティがあるOSSを優先
4. **ライセンス遵守**: 商用利用可能なライセンスを確認

### 🏗️ **基盤技術特別規定**
**基盤技術（通信、データベース、認証等）は最優先でOSS使用**

1. **基盤技術の定義**: システムの根幹となる横断的機能
   - 通信プロトコル（HTTP、gRPC、A2A等）
   - データベースアクセス（ORM、接続管理等）
   - 認証・認可（JWT、OAuth等）
   - ログ・監視（メトリクス、トレーシング等）

2. **基盤技術の特別要求**:
   - **100%OSS使用**: カスタム実装は原則禁止
   - **業界標準準拠**: 標準プロトコル・仕様の厳格遵守
   - **相互運用性確保**: 他システムとの連携を前提とした選定

---

## 🔍 **OSS選定プロセス**

### 1. **要件定義フェーズ**
```yaml
必須チェック項目:
  - 機能要件の明確化
  - 非機能要件（性能、セキュリティ）の定義
  - 技術制約の確認
```

### 2. **OSS調査フェーズ**
```yaml
調査必須項目:
  - GitHub Stars数（信頼性指標）
  - 最終更新日（メンテナンス状況）
  - Issue/PR対応速度（コミュニティ活性度）
  - ドキュメント充実度
  - 導入事例・実績
```

### 3. **技術評価フェーズ**
```yaml
評価基準:
  - 要件適合度: 80%以上
  - パフォーマンス: ベンチマーク実施
  - セキュリティ: 脆弱性チェック
  - 保守性: コード品質・テストカバレッジ
```

### 4. **承認フェーズ**
```yaml
承認プロセス:
  - 技術選定書作成（必須）
  - 同等OSS調査証明（3つ以上の比較必須）
  - エルダー評議会技術レビュー
  - 基盤技術の場合：追加審査（OSS不採用の場合）
  - グランドエルダー最終承認
```

### 5. **基盤技術カスタム実装審査**
```yaml
基盤技術でOSSを使用しない場合の特別審査:
  - 既存OSS調査報告書（最低5つ以上）
  - OSS不採用理由書（技術的・法的根拠）
  - 技術負債リスク評価書
  - 代替OSS移行計画書
  - エルダー評議会全員一致の承認
  - グランドエルダーの特別承認
```

---

## 🚫 **禁止事項**

### ❌ **絶対禁止**
1. **調査なしの自作実装**
2. **NIH症候群**（Not Invented Here）
3. **車輪の再発明**
4. **無断でのOSS fork**

### ⚠️ **例外申請が必要な場合**
1. セキュリティ上の重大な懸念
2. ライセンス互換性問題
3. 特殊要件で既存OSSが存在しない

### 🚨 **過去の違反事例と教訓**

#### 違反事例 #001: エルダーズギルド カスタムA2A実装
**発生時期**: 2025年7月  
**問題内容**: 基盤技術（A2A通信）のカスタム実装  
**利用可能だったOSS**: python-a2a (Google A2A Protocol実装)  

**問題点**:
- 分散処理不可（単一プロセス内通信のみ）
- スケーラビリティ欠如（水平スケーリング不可）
- 標準化逸脱（相互運用性なし）
- 高い技術負債（年間1000時間超の保守工数）

**教訓**:
1. 基盤技術では必ずOSS優先を厳守する
2. 「独自の要件」という思い込みを避ける
3. 標準プロトコルの重要性を軽視しない
4. 技術選定書なしでの実装を避ける

**対策**: 2025年8月 python-a2a移行完了予定

---

## 📊 **推奨OSSリスト**

### 🔧 **通信・メッセージング**
- **python-a2a**: Google A2A Protocol実装（推奨度: ★★★★★）**【基盤技術】**
- **gRPC**: Google製RPC（推奨度: ★★★★★）**【基盤技術】**
- **Celery**: 非同期タスクキュー（推奨度: ★★★★☆）
- **RabbitMQ/pika**: メッセージブローカー（推奨度: ★★★★☆）
- **Apache Kafka**: 大規模メッセージング（推奨度: ★★★★☆）

### 🌐 **Web/API**
- **FastAPI**: 高速WebAPI（推奨度: ★★★★★）
- **Django**: フルスタックWeb（推奨度: ★★★★☆）
- **Flask**: 軽量Web（推奨度: ★★★☆☆）

### 💾 **データベース**
- **PostgreSQL**: RDBMS（推奨度: ★★★★★）
- **Redis**: キャッシュ・セッション（推奨度: ★★★★★）
- **SQLAlchemy/SQLModel**: ORM（推奨度: ★★★★☆）

### 📊 **監視・ログ**
- **Prometheus**: メトリクス収集（推奨度: ★★★★★）
- **Grafana**: 可視化（推奨度: ★★★★★）
- **structlog**: 構造化ログ（推奨度: ★★★★☆）

### 🧪 **テスト・品質**
- **pytest**: テストフレームワーク（推奨度: ★★★★★）
- **black**: コードフォーマッター（推奨度: ★★★★★）
- **ruff**: 高速リンター（推奨度: ★★★★★）

### 🐳 **インフラ・デプロイ**
- **Docker**: コンテナ化（推奨度: ★★★★★）
- **Kubernetes**: オーケストレーション（推奨度: ★★★★☆）
- **Poetry**: パッケージ管理（推奨度: ★★★★★）

---

## 🎯 **実装前チェックリスト**

```yaml
□ 要件は明確に定義されているか？
□ 既存OSSを3つ以上調査したか？
□ 技術選定書を作成したか？
□ ライセンスを確認したか？
□ パフォーマンステストを実施したか？
□ セキュリティチェックを実施したか？
□ ドキュメントは充実しているか？
□ コミュニティは活発か？
□ 導入事例はあるか？
□ エルダー評議会の承認を得たか？
```

---

## 📋 **技術選定書テンプレート**

```markdown
# 技術選定書: [機能名]

## 要件
- 機能要件: 
- 非機能要件:
- 制約事項:

## 調査したOSS
1. **[OSS名]**
   - GitHub Stars: 
   - ライセンス:
   - 最終更新:
   - 評価: ★★★★☆

## 選定理由
- 

## リスクと対策
- 

## 承認
- 申請者: 
- 承認者:
- 承認日:
```

---

## 📅 **定期的技術負債レビュー**

### 🔍 **技術負債監査プロセス**
**頻度**: 四半期（3ヶ月ごと）実施

1. **カスタム実装の全数調査**
   - 基盤技術のカスタム実装リストアップ
   - OSS代替可能性の調査
   - 技術負債リスクの定量評価

2. **OSS適合性チェック**
   - 既存ライブラリの更新状況確認
   - より適切なOSSの出現チェック
   - 移行計画の策定

3. **技術選定書の定期更新**
   - 選定理由の再検証
   - 新しいOSSとの比較
   - 必要に応じた移行計画作成

### 📊 **技術負債指標**
```yaml
技術負債KPI:
  - カスタム実装比率: 10%以下を維持
  - 基盤技術OSS化率: 100%を維持
  - 平均保守工数: 前年比削減
  - セキュリティ更新対応: 1週間以内
```

---

## 🚨 **違反時の対応**

### 警告レベル
1. **初回**: 口頭注意・是正指導
2. **2回目**: エルダー評議会への報告
3. **3回目**: グランドエルダーへの直接報告

### 是正措置
- 即座に実装停止
- OSS調査実施
- 技術選定書作成
- 必要に応じて再実装

---

## 📝 **改訂履歴**

| 版 | 日付 | 内容 | 承認者 |
|----|------|------|--------|
| 1.0 | 2025-07-22 | 初版制定 | maru |
| 2.0 | 2025-07-23 | 強化版制定：基盤技術特別規定追加、技術負債レビュー導入、違反事例追加 | Claude Elder |

---

**Remember: Don't Reinvent the Wheel! 🎯**