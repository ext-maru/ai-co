# ğŸ›ï¸ ãƒŠãƒ¬ãƒƒã‚¸è³¢è€…ã®é­”æ³•æ›¸ã‚’è¸ã¾ãˆãŸå¼·åŒ–å®Ÿè¡Œè¨ˆç”»

## ğŸ“… è¨ˆç”»æ›´æ–°æ—¥æ™‚
2025å¹´7æœˆ10æ—¥ 03:15

## ğŸ“œ é­”æ³•æ›¸ã‹ã‚‰ã®é‡è¦äº‹é …
- TDDã‚µã‚¤ã‚¯ãƒ«ï¼ˆRedâ†’Greenâ†’Refactorï¼‰ã®å³å®ˆ
- å¤±æ•—å­¦ç¿’ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆFAIL-LEARN-EVOLVEï¼‰ã®é©ç”¨
- ğŸ›¡ï¸ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«å›£å‘ã‘è¨ä¼ä»»å‹™ã¨ã—ã¦åˆ†é¡

## ğŸ¯ å¼·åŒ–å®Ÿè¡Œè¨ˆç”»

### Phase 0: é­”æ³•æ›¸ç¢ºèªã¨ç’°å¢ƒæº–å‚™ï¼ˆ5åˆ†ï¼‰
```bash
# TDDãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆä½œæˆ
cat > tdd_checklist.md << EOF
â–¡ å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’å…ˆã«æ›¸ã„ãŸ
â–¡ ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸ
â–¡ æœ€å°é™ã®å®Ÿè£…ã§ãƒ†ã‚¹ãƒˆã‚’é€šã—ãŸ
â–¡ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸ
â–¡ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’å®Ÿæ–½ã—ãŸ
â–¡ ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒ67%ä»¥ä¸Šã‚’ç¶­æŒ
â–¡ 4è³¢è€…ã¸ã®ç›¸è«‡è¨˜éŒ²ã‚’æ®‹ã—ãŸ
EOF

# ç’°å¢ƒæº–å‚™
pip install pytest-mock==3.14.0 --break-system-packages

# ç¾çŠ¶è¨˜éŒ²ï¼ˆé­”æ³•æ›¸æ¨å¥¨ï¼‰
python3 -m pytest tests/ -v > test_results_before_$(date +%Y%m%d_%H%M%S).txt
git stash save "ãƒ†ã‚¹ãƒˆä¿®æ­£å‰ã®çŠ¶æ…‹ä¿å­˜"
```

### Phase 1: åŸºç›¤ä¿®æ­£ï¼ˆ15åˆ†ï¼‰- ä¸¦åˆ—å®Ÿè¡Œ ğŸ›¡ï¸

#### ã‚¿ã‚¹ã‚¯1: models.pyä¿®æ­£ã€ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«2åé…ç½®ã€‘
```python
# TDDã‚µã‚¤ã‚¯ãƒ«é©ç”¨
# 1. Red: ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
python3 -m pytest tests/unit/test_models.py -v

# 2. Green: æœ€å°é™ã®ä¿®æ­£
# - server_default=func.now()è¿½åŠ 
# - __repr__ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…
# - éŠ€è¡Œæ˜ç´°è¡¨ç¤ºåä¿®æ­£

# 3. Refactor: ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Š
```

#### ã‚¿ã‚¹ã‚¯2: conftest.pyä¿®æ­£ã€ã‚¨ãƒ«ãƒ•1åé…ç½®ã€‘
```python
# é­”æ³•æ›¸æ¨å¥¨: ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒªã‚»ãƒƒãƒˆ
@pytest.fixture(autouse=True)
def reset_google_drive_singleton():
    """Google Driveã‚µãƒ¼ãƒ“ã‚¹ã®ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã‚’ãƒªã‚»ãƒƒãƒˆ"""
    from google_drive_service import GoogleDriveService
    if hasattr(GoogleDriveService, '_instance'):
        delattr(GoogleDriveService, '_instance')
```

#### ã‚¿ã‚¹ã‚¯3: google_drive_service.pyä¿®æ­£ã€ãƒ‰ãƒ¯ãƒ¼ãƒ•å·¥æˆ¿3åé…ç½®ã€‘
```python
# é­”æ³•æ›¸è­¦å‘Š: MediaFileUploadã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯å¿…é ˆ
from googleapiclient.http import MediaFileUpload

# ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…ï¼ˆä¼èª¬è£…å‚™é›é€ ãƒ¬ãƒ™ãƒ«ï¼‰
def create_folder(self, folder_name: str, parent_folder_id: Optional[str] = None)
def upload_file(self, file_path: str, filename: str, folder_id: Optional[str] = None)
```

### Phase 2: ä¾å­˜ä¿®æ­£ï¼ˆ10åˆ†ï¼‰- é€æ¬¡å®Ÿè¡Œ

#### ã‚¿ã‚¹ã‚¯4: app.pyä¿®æ­£ã€RAGã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰2åé…ç½®ã€‘
```python
# é­”æ³•æ›¸æ³¨æ„: EXIFå‡¦ç†ã¯æœ€æ–°APIã‚’ä½¿ç”¨
try:
    exif = img.getexif()  # æ–°API
    # æ—§API: img._getexif() ã¯ä½¿ç”¨ç¦æ­¢
except:
    pass
```

### Phase 3: å“è³ªæ¤œè¨¼ï¼ˆ10åˆ†ï¼‰

#### 3.1 æ®µéšçš„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆé­”æ³•æ›¸æ¨å¥¨ï¼‰
```bash
# å€‹åˆ¥ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python3 -m pytest tests/unit/test_models.py -v
python3 -m pytest tests/unit/test_google_drive_service.py -v
python3 -m pytest tests/unit/test_app_routes.py -v

# çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python3 -m pytest tests/ -v --cov=app --cov-report=term-missing
```

#### 3.2 æˆåŠŸåŸºæº–ç¢ºèªï¼ˆå¼·åŒ–ç‰ˆï¼‰
- âœ… 19å€‹ã®å¤±æ•—ãƒ†ã‚¹ãƒˆãŒã™ã¹ã¦PASS
- âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸67%ä»¥ä¸Šï¼ˆç›®æ¨™70%ï¼‰
- âœ… æ–°è¦å¤±æ•—ã‚¼ãƒ­
- âœ… TDDãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆå…¨é …ç›®ã‚¯ãƒªã‚¢
- âœ… pre-commitãƒã‚§ãƒƒã‚¯ãƒ‘ã‚¹

### Phase 4: å¤±æ•—å­¦ç¿’ãƒ—ãƒ­ãƒˆã‚³ãƒ«é©ç”¨ï¼ˆéšæ™‚ï¼‰

```bash
# ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®å³æ™‚å¯¾å¿œ
if [ $? -ne 0 ]; then
    echo "ğŸš¨ ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ - å¤±æ•—å­¦ç¿’ãƒ—ãƒ­ãƒˆã‚³ãƒ«ç™ºå‹•"
    
    # Phase 1: å³åº§ã«ä½œæ¥­åœæ­¢
    git stash
    
    # Phase 2: 4è³¢è€…ç›¸è«‡ï¼ˆ5åˆ†ä»¥å†…ï¼‰
    ai-incident-report --severity high --type test_failure
    
    # Phase 3: çŸ¥è­˜è¨˜éŒ²
    cat > knowledge_base/failures/test_fix_$(date +%Y%m%d_%H%M%S).md << EOF
    ## å¤±æ•—å†…å®¹
    [è©³ç´°è¨˜éŒ²]
    
    ## åŸå› åˆ†æ
    [4è³¢è€…ã«ã‚ˆã‚‹åˆ†æ]
    
    ## è§£æ±ºç­–
    [å®Ÿæ–½ã—ãŸå¯¾ç­–]
    
    ## å­¦ç¿’äº‹é …
    [ä»Šå¾Œã®æ”¹å–„ç‚¹]
    EOF
fi
```

## ğŸ† ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã®è©•è­°ä¼šå ±å‘Š

### å ±å‘Šå†…å®¹ï¼ˆé­”æ³•æ›¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰
```markdown
# ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«å›£ è¨ä¼ä»»å‹™å®Œäº†å ±å‘Š

## ä»»å‹™æ¦‚è¦
- ä»»å‹™ç¨®åˆ¥: ãƒ†ã‚¹ãƒˆå¤±æ•—ãƒã‚°è¨ä¼ï¼ˆMEDIUMï½HIGHï¼‰
- è¨ä¼å¯¾è±¡: 19ä½“ã®ãƒ†ã‚¹ãƒˆå¤±æ•—ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼
- å‚åŠ è€…: ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«ã€ã‚¨ãƒ«ãƒ•ã€ãƒ‰ãƒ¯ãƒ¼ãƒ•ã€RAGã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰

## æˆ¦æœ
- è¨ä¼æˆåŠŸæ•°: X/19
- ã‚«ãƒãƒ¬ãƒƒã‚¸: XX%
- æ–°è¦ç™ºç”Ÿ: 0

## ä½¿ç”¨ã—ãŸé­”æ³•ãƒ»æŠ€è¡“
- TDDã‚µã‚¤ã‚¯ãƒ«é­”æ³•
- ä¸¦åˆ—å‡¦ç†ã‚¨ãƒ«ãƒ•è¡“
- ãƒ‰ãƒ¯ãƒ¼ãƒ•é›é€ æŠ€è¡“

## ç²å¾—ã—ãŸçŸ¥è­˜
[ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã¸ã®è¿½åŠ å†…å®¹]
```

## ğŸ¯ å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ï¼ˆå¼·åŒ–ç‰ˆï¼‰

```bash
# é­”æ³•æ›¸ãƒã‚§ãƒƒã‚¯ä»˜ãå®Ÿè¡Œ
ai-task-elder-execute \
  --plan ./enhanced_execution_plan.md \
  --tdd-check \
  --fail-learn-protocol \
  --parallel \
  --monitor

# ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«å›£ãƒ¢ãƒ¼ãƒ‰
ai-incident-knights \
  --quest subjugation \
  --target test_failures \
  --count 19
```

---
è¨ˆç”»ç­–å®šï¼šã‚¯ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ«ãƒ€ãƒ¼
é­”æ³•æ›¸ç›£ä¿®ï¼šãƒŠãƒ¬ãƒƒã‚¸è³¢è€…
æ‰¿èªï¼šã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰4è³¢è€…è©•è­°ä¼š