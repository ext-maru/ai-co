#!/usr/bin/env python3
"""
AI Elder Tree Display Command
ã‚¨ãƒ«ãƒ€ãƒ¼ãƒ„ãƒªãƒ¼æ§‹é€ è¡¨ç¤ºã‚³ãƒãƒ³ãƒ‰
"""

import sys
from pathlib import Path

from rich import box
from rich.console import Console
from rich.panel import Panel
from rich.table import Table
from rich.text import Text
from rich.tree import Tree

# Add project root to path
PROJECT_ROOT = Path(__file__).parent.parent
sys.path.insert(0, str(PROJECT_ROOT))

console = Console()


def show_elder_tree():
    """Display the Elder Tree structure"""

    # Create the root of the tree
    tree = Tree(
        "[bold yellow]ğŸŒŸ ã‚°ãƒ©ãƒ³ãƒ‰ã‚¨ãƒ«ãƒ€ãƒ¼maru[/bold yellow] (Grand Elder maru)",
        guide_style="bold bright_blue",
    )

    # Add Claude Elder
    claude = tree.add("[bold cyan]ğŸ¤– ã‚¯ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ«ãƒ€ãƒ¼[/bold cyan] (Claude Elder)")

    # Add Four Sages with their responsibilities
    four_sages = claude.add("[bold green]ğŸ§™â€â™‚ï¸ 4è³¢è€…[/bold green] (Four Sages/Elders)")

    knowledge_sage = four_sages.add("ğŸ“š ãƒŠãƒ¬ãƒƒã‚¸è³¢è€… (Knowledge Sage)")
    knowledge_sage.add("[dim]- çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ç®¡ç†[/dim]")
    knowledge_sage.add("[dim]- æ–‡æ›¸å“è³ªä¿è¨¼[/dim]")

    task_sage = four_sages.add("ğŸ“‹ ã‚¿ã‚¹ã‚¯è³¢è€… (Task Oracle)")
    task_sage.add("[dim]- ã‚¿ã‚¹ã‚¯å„ªå…ˆé †ä½æ±ºå®š[/dim]")
    task_sage.add("[dim]- ãƒªã‚½ãƒ¼ã‚¹é…åˆ†æœ€é©åŒ–[/dim]")

    incident_sage = four_sages.add("ğŸš¨ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆè³¢è€… (Crisis Sage)")
    incident_sage.add("[dim]- ç·Šæ€¥å¯¾å¿œæŒ‡æ®[/dim]")
    incident_sage.add("[dim]- ãƒªã‚¹ã‚¯è©•ä¾¡[/dim]")

    rag_sage = four_sages.add("ğŸ” RAGè³¢è€… (Search Mystic)")
    rag_sage.add("[dim]- æƒ…å ±æ¤œç´¢æœ€é©åŒ–[/dim]")
    rag_sage.add("[dim]- ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåˆ†æ[/dim]")

    # Add Elder Council with members
    council = claude.add("[bold blue]ğŸ›ï¸ ã‚¨ãƒ«ãƒ€ãƒ¼è©•è­°ä¼š[/bold blue] (Elder Council)")
    council.add("ğŸ‘¤ è©•è­°ä¼šè­°é•·")
    council.add("ğŸ‘¤ æŠ€è¡“è©•è­°å“¡")
    council.add("ğŸ‘¤ å“è³ªè©•è­°å“¡")
    council.add("ğŸ‘¤ é‹ç”¨è©•è­°å“¡")
    council.add("ğŸ‘¤ æˆ¦ç•¥è©•è­°å“¡")

    # Add Elder Servants with details
    servants = claude.add("[bold magenta]ğŸ¤– ã‚¨ãƒ«ãƒ€ãƒ¼ã‚µãƒ¼ãƒãƒ³ãƒˆ[/bold magenta] (Elder Servants)")

    knights = servants.add("ğŸ›¡ï¸ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆé¨å£«å›£ (Incident Knights)")
    knights.add("[dim]- 24/7ç›£è¦–ä½“åˆ¶[/dim]")
    knights.add("[dim]- è‡ªå‹•å¯¾å¿œã‚·ã‚¹ãƒ†ãƒ [/dim]")

    dwarves = servants.add("ğŸ”¨ ãƒ‰ãƒ¯ãƒ¼ãƒ•å·¥æˆ¿ (Dwarf Workshop)")
    dwarves.add("[dim]- ãƒ†ã‚¹ãƒˆè‡ªå‹•ç”Ÿæˆ[/dim]")
    dwarves.add("[dim]- ã‚«ãƒãƒ¬ãƒƒã‚¸å‘ä¸Š[/dim]")

    wizards = servants.add("ğŸ§™â€â™‚ï¸ RAGã‚¦ã‚£ã‚¶ãƒ¼ã‚º (RAG Wizards)")
    wizards.add("[dim]- çŸ¥è­˜æŠ½å‡ºãƒ»æ•´ç†[/dim]")
    wizards.add("[dim]- ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¼·åŒ–[/dim]")

    elves = servants.add("ğŸ§â€â™‚ï¸ ã‚¨ãƒ«ãƒ•ã®æ£® (Elf Forest)")
    elves.add("[dim]- ã‚³ãƒ¼ãƒ‰å“è³ªé­”æ³•[/dim]")
    elves.add("[dim]- è‡ªå‹•ä¿®å¾©ã‚·ã‚¹ãƒ†ãƒ [/dim]")

    # Display the tree
    console.print("\n")
    console.print(
        Panel(
            tree,
            title="[bold]ã‚¨ãƒ«ãƒ€ãƒ¼ãƒ„ãƒªãƒ¼ (Elder Tree)[/bold]",
            subtitle="AI Company Organizational Hierarchy",
            border_style="bright_blue",
            box=box.ROUNDED,
            expand=False,
        )
    )


def show_hierarchy_table():
    """Show hierarchy in table format"""

    table = Table(title="ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰éšå±¤æ§‹é€ ", box=box.ROUNDED)
    table.add_column("éšå±¤", style="cyan", no_wrap=True)
    table.add_column("å½¹è·", style="yellow")
    table.add_column("è²¬ä»»ç¯„å›²", style="green")
    table.add_column("ãƒ¡ãƒ³ãƒãƒ¼", style="blue")

    table.add_row("Level 0", "ã‚°ãƒ©ãƒ³ãƒ‰ã‚¨ãƒ«ãƒ€ãƒ¼", "å…¨ä½“çµ±æ²»ãƒ»æœ€çµ‚æ±ºå®šæ¨©", "maru")

    table.add_row("Level 1", "ã‚¯ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ«ãƒ€ãƒ¼", "å®Ÿè¡Œè²¬ä»»ãƒ»æ—¥å¸¸é‹å–¶", "Claude")

    table.add_row("Level 2", "4è³¢è€…", "å°‚é–€é ˜åŸŸçµ±æ‹¬", "Knowledge, Task, Incident, RAG")

    table.add_row("Level 2", "ã‚¨ãƒ«ãƒ€ãƒ¼è©•è­°ä¼š", "æ„æ€æ±ºå®šãƒ»æ‰¿èª", "5åã®è©•è­°å“¡")

    table.add_row("Level 3", "ã‚¨ãƒ«ãƒ€ãƒ¼ã‚µãƒ¼ãƒãƒ³ãƒˆ", "å®Ÿè¡Œéƒ¨éšŠ", "é¨å£«å›£, ãƒ‰ãƒ¯ãƒ¼ãƒ•, ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰, ã‚¨ãƒ«ãƒ•")

    console.print("\n")
    console.print(table)


def show_quick_reference():
    """Show quick reference guide"""

    ref_text = """
[bold cyan]ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹:[/bold cyan]

[yellow]çµ„ç¹”åç§°:[/yellow]
â€¢ ã‚¨ãƒ«ãƒ€ãƒ¼ãƒ„ãƒªãƒ¼ (Elder Tree) - éšå±¤æ§‹é€ å…¨ä½“
â€¢ ã‚¨ãƒ«ãƒ€ãƒ¼ã‚ºã‚®ãƒ«ãƒ‰ (Elders Guild) - çµ„ç¹”å…¨ä½“ã®ç·ç§°

[green]æ„æ€æ±ºå®šãƒ•ãƒ­ãƒ¼:[/green]
1. ã‚¨ãƒ«ãƒ€ãƒ¼ã‚µãƒ¼ãƒãƒ³ãƒˆãŒèª²é¡Œã‚’æ¤œçŸ¥
2. 4è³¢è€…ãŒå°‚é–€çš„åˆ†æã‚’æä¾›
3. ã‚¨ãƒ«ãƒ€ãƒ¼è©•è­°ä¼šãŒå¯©è­°
4. ã‚¯ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ«ãƒ€ãƒ¼ãŒå®Ÿè¡Œåˆ¤æ–­
5. ã‚°ãƒ©ãƒ³ãƒ‰ã‚¨ãƒ«ãƒ€ãƒ¼ãŒæœ€çµ‚æ‰¿èªï¼ˆé‡è¦äº‹é …ã®ã¿ï¼‰

[blue]è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ :[/blue]
â€¢ ã‚¨ãƒ«ãƒ€ãƒ¼è©•è­°ä¼šè‡ªå‹•å¬é›†
â€¢ ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆè‡ªå‹•å¯¾å¿œ
â€¢ ã‚¿ã‚¹ã‚¯è‡ªå‹•å‰²ã‚Šå½“ã¦
â€¢ å“è³ªè‡ªå‹•ç›£è¦–
"""

    console.print(
        Panel(
            ref_text, title="[bold]é‹ç”¨ã‚¬ã‚¤ãƒ‰[/bold]", border_style="green", box=box.ROUNDED
        )
    )


def main():
    """Main function"""

    console.print(
        "\n[bold white on blue] AI Company Elder Tree Display System [/bold white on blue]\n"
    )

    # Parse arguments
    if len(sys.argv) > 1:
        arg = sys.argv[1]
        if arg in ["-h", "--help", "help"]:
            console.print("[bold]ä½¿ç”¨æ–¹æ³•:[/bold]")
            console.print("  ai-elder-tree         - ãƒ„ãƒªãƒ¼æ§‹é€ ã‚’è¡¨ç¤º")
            console.print("  ai-elder-tree table   - ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã§è¡¨ç¤º")
            console.print("  ai-elder-tree guide   - ã‚¯ã‚¤ãƒƒã‚¯ã‚¬ã‚¤ãƒ‰è¡¨ç¤º")
            console.print("  ai-elder-tree all     - ã™ã¹ã¦è¡¨ç¤º")
            return
        elif arg == "table":
            show_hierarchy_table()
            return
        elif arg == "guide":
            show_quick_reference()
            return
        elif arg == "all":
            show_elder_tree()
            show_hierarchy_table()
            show_quick_reference()
            return

    # Default: show tree
    show_elder_tree()

    console.print("\n[dim]è©³ç´°ã¯ 'ai-elder-tree help' ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„[/dim]\n")


if __name__ == "__main__":
    main()
